tmap_animation(hex_map_list, "hex_map_list.gif", width = 400, height = 500, delay = 50)
View(hexagons_hom_ct_yr)
?seq
seq(1940, 1964, 5)
test1 = hexagons_hom_ct_yr %>% filter(between(year, 1940, 1944))
View(test1)
View(hexagons_hom_ct_yr)
?paste
1940/5
1945/5
1945-1939
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
View(CA_map_list_5yr)
tmap_animation(CA_map_list, "CA_map_list.gif", width = 400, height = 500, delay = 100)
CA_map_list = list()
for (n in 1940:1964) {
data = CAs_hom_ct_yr %>% filter(year == n)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste("Homicides in", n))
CA_map_list[[n-1939]] = map
rm(n, data, map)
}
tmap_animation(CA_map_list, "CA_map_list.gif", width = 400, height = 500, delay = 50)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tm_shape(pt2_after_hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,500,1000,Inf), title="Homicides 1965-2020", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
tm_shape(pt2_after_hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,Inf), title="Homicides 1965-2020", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
tmap_mode("view")
tm_shape(pt2_before_hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,500,Inf), title="Homicides 1874-1930", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
tm_shape(pt2_after_hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,500,Inf), title="Homicides 1965-2020", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
###  %>% mutate(hom_ct = ifelse(is.na(hom_ct), 0, hom_ct))
tmap_mode("view")
tm_shape(pt2_before_hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,Inf), title="Homicides 1874-1930", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
tm_shape(pt2_after_hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,Inf), title="Homicides 1965-2020", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
###  %>% mutate(hom_ct = ifelse(is.na(hom_ct), 0, hom_ct))
tmap_mode("view")
tm_shape(hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,Inf), title="Homicides", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
tmap_mode("view")
tm_shape(hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,500,Inf), title="Homicides", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
CA_map_list = list()
for (n in 1940:1964) {
data = CAs_hom_ct_yr %>% filter(year == n)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste("Homicides in", n))
CA_map_list[[n-1939]] = map
rm(n, data, map)
}
tmap_animation(CA_map_list, "CA_map_list.gif", width = 400, height = 500, delay = 50)
CA_map_list = list()
for (n in 1940:1964) {
data = CAs_hom_ct_yr %>% filter(year == n)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste("Homicides in", n))
CA_map_list[[n-1939]] = map
rm(n, data, map)
}
tmap_animation(CA_map_list, "CA_map_list.gif", width = 400, height = 500, delay = 50)
tmap_mode("view")
tm_shape(hexagons_hom_ct) + tm_polygons(col = "hom_ct", breaks = c(0,1,5,10,50,100,Inf), title="Homicides", id="hom_ct", popup.vars = c("Grid ID:" = "GRID_ID", "Homicides:" = "hom_ct"))
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
View(hexagons_hom_ct_yr)
View(pt2_after_only)
View(pt2_after_aggregated)
View(hexagons_hom_ct_yr)
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
aggregated_data = aggregate(.~GRID_ID, data = data, FUN = sum)
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
#aggregated_data = aggregate(.~GRID_ID, data = data, FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
aggregated_data = aggregate(.~GRID_ID, data = data, FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
class(data)
aggregated_data = aggregate(.~GRID_ID, data = data, FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
class(data)
#aggregated_data = aggregate(.~GRID_ID, data = data, FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
#aggregated_data = aggregate(.~GRID_ID, data = data, FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, map)
}
View(data)
View(aggregated_data)
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(data, by = GRID_ID)
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(data, by = "GRID_ID")
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(data, by = "GRID_ID")
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
View(aggregated_data)
View(hexagons)
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID")
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
rm(n, data, map)
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4)) %>% select(GRID_ID, hom_ct)
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID")
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
View(aggregated_data)
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
print(paste(class(data)))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID")
map = tm_shape(data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
View(aggregated_data)
View(CAs_hom_ct_yr)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID")
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1")
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, map)
}
View(aggregated_data)
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
print(paste(aggregated_data[aggregated_data$community == "NEAR WEST SIDE", 2]))
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
print(paste(aggregated_data[aggregated_data$community == "NEAR WEST SIDE", 1]))
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
print(paste(aggregated_data[aggregated_data$community == "NEAR WEST SIDE", 1:2]))
rm(n, data, aggregated_data, map)
}
hex_map_list_5yr = list()
CA_map_list_5yr = list()
for (n in seq(1940, 1964, 5)) {
data = hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
hex_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1940, 1964, 5)) {
data = CAs_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$area_num_1), FUN = sum) %>% rename(area_num_1 = Group.1, hom_ct = x) %>% left_join(CAs, by = "area_num_1") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, 100, Inf), title = paste0("Homicides in ", n, "-", n+4))
CA_map_list_5yr[[1+((n-1940)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(hex_map_list_5yr, "hex_map_list_5yr.gif", width = 400, height = 500, delay = 100)
tmap_animation(CA_map_list_5yr, "CA_map_list_5yr.gif", width = 400, height = 500, delay = 100)
1930-1874
2020-19645
2020-1965
seq(1875, 1929, 5)
seq(1965, 2020, 5)
seq(1965, 2019, 5)
pt2_map_list_before = list()
pt2_map_list_after = list()
for (n in seq(1875, 1929, 5)) {
data = pt2_hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
pt2_map_list_before[[1+((n-1875)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1965, 2019, 5)) {
data = pt2_hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
pt2_map_list_after[[1+((n-1965)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(pt2_map_list_before, "hex_map_list_before.gif", width = 400, height = 500, delay = 100)
tmap_animation(pt2_map_list_after, "hex_map_list_after.gif", width = 400, height = 500, delay = 100)
View(pt2_hexagons_yr)
View(pt2_hex_freq_table_yr)
pt2_map_list_before = list()
pt2_map_list_after = list()
for (n in seq(1875, 1929, 5)) {
data = pt2_hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
pt2_map_list_before[[1+((n-1875)/5)]] = map
rm(n, data, aggregated_data, map)
}
for (n in seq(1965, 2014, 5)) {
data = pt2_hexagons_hom_ct_yr %>% filter(between(year, n, n+4))
aggregated_data = aggregate(data$hom_ct, list(data$GRID_ID), FUN = sum) %>% rename(GRID_ID = Group.1, hom_ct = x) %>% left_join(hexagons, by = "GRID_ID") %>% st_as_sf()
map = tm_shape(aggregated_data) + tm_polygons(col = "hom_ct", breaks = c(0, 1, 5, 10, 50, Inf), title = paste0("Homicides in ", n, "-", n+4))
pt2_map_list_after[[1+((n-1965)/5)]] = map
rm(n, data, aggregated_data, map)
}
tmap_animation(pt2_map_list_before, "hex_map_list_before.gif", width = 400, height = 500, delay = 100)
tmap_animation(pt2_map_list_after, "hex_map_list_after.gif", width = 400, height = 500, delay = 100)
knitr::opts_chunk$set(echo = TRUE)
tmap_animation(c(pt2_map_list_before, hex_map_list_5yr, pt2_map_list_after), "hex_map_list_all.gif", width = 400, height = 500, delay = 100)
library(sf)
library(dplyr)
library(tmap)
library(leaflet)
library(leafgl)
library(crosstalk)
library(sfdep)
tmap_animation(c(pt2_map_list_before, hex_map_list_5yr, pt2_map_list_after), "hex_map_list_all.gif", width = 400, height = 500, delay = 100)
View(CAs_hom_ct_yr)
View(CA_freq_table_yr)
View(CAs)
annexed_CAs = read.csv("annexed/annexed.csv")
View(annexed_CAs)
rm(annexed_CAs)
annexed_CAs = read.csv("annexed/annexed.csv")
View(annexed_CAs)
View(annexed_CAs)
rm(annexed_CAs)
annexed = CAs_hom_ct_yr %>% left_join(annexed_CAs, by="community")
annexed_CAs = read.csv("annexed/annexed.csv")
View(annexed_CAs)
annexed = CAs_hom_ct_yr %>% left_join(annexed_CAs, by="community")
View(annexed)
annexed = CAs_hom_ct_yr %>% left_join(annexed_CAs, by="community") %>% mutate(annexed = ifelse(is.na(annexed), 0, annexed))
View(annexed)
annexed = CAs_hom_ct_yr %>% left_join(annexed_CAs, by="community") %>% mutate(annexed = ifelse(is.na(annexed), 0, annexed)) %>% select(area_num_1, year, community, hom_ct, annexed) %>% st_drop_geometry()
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum)
View(annexed_aggregated)
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum) %>% rename(year = Group.1, annexed = Group.2, hom_ct = x)
reshape(annexed_aggregated, idvar = "year", timevar = "annexed", direction = "wide")
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum)
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum) %>% reshape(idvar = "Group.1", timevar = "Group.2", direction = "wide")
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum) %>% reshape(idvar = "Group.1", timevar = "Group.2", direction = "wide") %>% rename(year = Group.1, hom_ct_notannexed = x.0, hom_ct_annexed = x.1)
plot(annexed_aggregated)
plot(annexed_aggregated, type="o")
plot(annexed_aggregated, type= "o")
library(ggplot2)
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct_annexed, group=1)) +
geom_line()+
geom_point()
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum) %>% rename(year = Group.1)
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum) %>% rename(year = Group.1, annexed = Group.2, hom_ct = x)
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line()+
geom_point()
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line(aes(color = annexed)) +
geom_point()
annexed = CAs_hom_ct_yr %>% left_join(annexed_CAs, by="community") %>% mutate(annexed = ifelse(is.na(annexed), "Not Annexed", "Annexed")) %>% select(area_num_1, year, community, hom_ct, annexed) %>% st_drop_geometry()
annexed_aggregated = aggregate(annexed$hom_ct, list(annexed$year, annexed$annexed), FUN = sum) %>% rename(year = Group.1, annexed = Group.2, hom_ct = x)
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line(aes(color = annexed)) +
geom_point()
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line(aes(color = annexed), width = 1) +
geom_point()
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line(aes(color = annexed), width = 10) +
geom_point()
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line(aes(color = annexed), size = 10) +
geom_point()
# Line Graph
ggplot(data = annexed_aggregated, aes(x = year, y = hom_ct, group = annexed)) +
geom_line(aes(color = annexed), size = 1) +
geom_point()
